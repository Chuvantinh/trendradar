{"ast":null,"code":"import _asyncToGenerator from \"/Users/vantinhchu/Documents/07_Projects/IntelliJ/trendradar/angular/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport { gql } from 'apollo-angular';\nimport { User } from \"../models/user\";\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"apollo-angular\";\nimport * as i2 from \"./notification.service\";\nimport * as i3 from \"@angular/router\";\nexport class AuthService {\n  constructor(apollo, notification, router) {\n    this.apollo = apollo;\n    this.notification = notification;\n    this.router = router;\n    this.tokenObj = '';\n  }\n\n  login(email, password) {\n    var _this = this;\n\n    return _asyncToGenerator(function* () {\n      const LOGIN = gql`\n      mutation login($data: UserAuthPayload!) {\n        login(data: $data)\n      }\n    `;\n      yield _this.apollo.mutate({\n        mutation: LOGIN,\n        variables: {\n          data: {\n            email: email,\n            password: password\n          }\n        }\n      }).subscribe(({\n        data\n      }) => {\n        _this.tokenObj = data;\n\n        _this.notification.showSuccess('Login success', 'trendradar.com');\n\n        _this.router.navigateByUrl('home'); // redirect to home\n\n      }, error => {\n        _this.notification.showError('Something gone wrong', 'trendradar.com');\n      });\n      let date = new Date(\"2019-01-16\");\n      console.log('in authservice : ' + _this.tokenObj);\n      return _this.tokenObj;\n    })();\n  }\n\n  signUp(email, password) {\n    const REGISTER = gql`\n      mutation signupUser($data: UserCreateInput!) {\n        signupUser(data: $data){\n          id\n          name\n        }\n      }\n    `;\n    this.apollo.mutate({\n      mutation: REGISTER,\n      variables: {\n        data: {\n          email: email,\n          name: email,\n          password: password\n        }\n      }\n    }).subscribe(({\n      data\n    }) => {\n      console.log(data);\n      this.notification.showSuccess('Login success', 'trendradar.com');\n      this.router.navigateByUrl('home'); // redirect to home\n\n      return {\n        data\n      };\n    }, error => {\n      this.notification.showError('Something gone wrong', 'trendradar.com');\n    });\n  }\n\n  formatUser(email, token, localId, expriration) {\n    return new User(email, token, localId, expriration);\n  }\n\n}\n\nAuthService.ɵfac = function AuthService_Factory(t) {\n  return new (t || AuthService)(i0.ɵɵinject(i1.Apollo), i0.ɵɵinject(i2.NotificationService), i0.ɵɵinject(i3.Router));\n};\n\nAuthService.ɵprov = /*@__PURE__*/i0.ɵɵdefineInjectable({\n  token: AuthService,\n  factory: AuthService.ɵfac,\n  providedIn: 'root'\n});","map":{"version":3,"sources":["/Users/vantinhchu/Documents/07_Projects/IntelliJ/trendradar/angular/src/app/services/auth.ts"],"names":[],"mappings":";AAEA,SAAgB,GAAhB,QAA0B,gBAA1B;AAEA,SAAQ,IAAR,QAAmB,gBAAnB;;;;;AAOA,OAAM,MAAO,WAAP,CAAkB;AAGtB,EAAA,WAAA,CACU,MADV,EAEU,YAFV,EAGU,MAHV,EAGwB;AAFd,SAAA,MAAA,GAAA,MAAA;AACA,SAAA,YAAA,GAAA,YAAA;AACA,SAAA,MAAA,GAAA,MAAA;AALF,SAAA,QAAA,GAAgB,EAAhB;AAMH;;AACC,EAAA,KAAK,CAAC,KAAD,EAAgB,QAAhB,EAAgC;AAAA;;AAAA;AAEzC,YAAM,KAAK,GAAG,GAAG;;;;AAIhB,KAJD;AAMA,YAAM,KAAI,CAAC,MAAL,CAAY,MAAZ,CAAmB;AACvB,QAAA,QAAQ,EAAE,KADa;AAEvB,QAAA,SAAS,EAAE;AACT,UAAA,IAAI,EAAE;AACJ,YAAA,KAAK,EAAE,KADH;AAEJ,YAAA,QAAQ,EAAE;AAFN;AADG;AAFY,OAAnB,EAQH,SARG,CAQO,CAAC;AAAC,QAAA;AAAD,OAAD,KAAW;AACtB,QAAA,KAAI,CAAC,QAAL,GAAgB,IAAhB;;AAEA,QAAA,KAAI,CAAC,YAAL,CAAkB,WAAlB,CAA8B,eAA9B,EAA+C,gBAA/C;;AACA,QAAA,KAAI,CAAC,MAAL,CAAY,aAAZ,CAA0B,MAA1B,EAJsB,CAIa;;AAEpC,OAdK,EAcF,KAAD,IAAU;AACX,QAAA,KAAI,CAAC,YAAL,CAAkB,SAAlB,CAA4B,sBAA5B,EAAoD,gBAApD;AACD,OAhBK,CAAN;AAkBA,UAAI,IAAI,GAAS,IAAI,IAAJ,CAAS,YAAT,CAAjB;AACA,MAAA,OAAO,CAAC,GAAR,CAAY,sBAAsB,KAAI,CAAC,QAAvC;AACA,aAAO,KAAI,CAAC,QAAZ;AA5ByC;AA6B1C;;AAED,EAAA,MAAM,CAAC,KAAD,EAAgB,QAAhB,EAAgC;AACpC,UAAM,QAAQ,GAAG,GAAG;;;;;;;AAOnB,KAPD;AASA,SAAK,MAAL,CAAY,MAAZ,CAAmB;AACjB,MAAA,QAAQ,EAAE,QADO;AAEjB,MAAA,SAAS,EAAE;AACT,QAAA,IAAI,EAAE;AACJ,UAAA,KAAK,EAAE,KADH;AAEJ,UAAA,IAAI,EAAE,KAFF;AAGJ,UAAA,QAAQ,EAAE;AAHN;AADG;AAFM,KAAnB,EASG,SATH,CASa,CAAC;AAAC,MAAA;AAAD,KAAD,KAAW;AACtB,MAAA,OAAO,CAAC,GAAR,CAAY,IAAZ;AACA,WAAK,YAAL,CAAkB,WAAlB,CAA8B,eAA9B,EAA+C,gBAA/C;AACA,WAAK,MAAL,CAAY,aAAZ,CAA0B,MAA1B,EAHsB,CAGa;;AACnC,aAAO;AAAC,QAAA;AAAD,OAAP;AACD,KAdD,EAcI,KAAD,IAAU;AACX,WAAK,YAAL,CAAkB,SAAlB,CAA4B,sBAA5B,EAAoD,gBAApD;AACD,KAhBD;AAiBD;;AAED,EAAA,UAAU,CAAC,KAAD,EAAgB,KAAhB,EAA+B,OAA/B,EAAgD,WAAhD,EAAiE;AACzE,WAAO,IAAI,IAAJ,CAAS,KAAT,EAAe,KAAf,EAAsB,OAAtB,EAA+B,WAA/B,CAAP;AACD;;AAtEqB;;;mBAAX,W,EAAW,EAAA,CAAA,QAAA,CAAA,EAAA,CAAA,MAAA,C,EAAA,EAAA,CAAA,QAAA,CAAA,EAAA,CAAA,mBAAA,C,EAAA,EAAA,CAAA,QAAA,CAAA,EAAA,CAAA,MAAA,C;AAAA,C;;;SAAX,W;AAAW,EAAA,OAAA,EAAX,WAAW,CAAA,I;AAAA,EAAA,UAAA,EAFV","sourcesContent":["import { Injectable } from '@angular/core';\nimport {NotificationService} from \"./notification.service\";\nimport {Apollo, gql} from 'apollo-angular';\nimport {Router} from \"@angular/router\";\nimport {User} from \"../models/user\";\nimport { from, of } from 'rxjs';\nimport {Observable} from \"rxjs\";\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class AuthService {\n  private tokenObj: any = '';\n\n  constructor(\n    private apollo: Apollo,\n    private notification: NotificationService,\n    private router: Router,\n  ) { }\n  async login(email: string, password: string): Observable<any>{\n\n    const LOGIN = gql`\n      mutation login($data: UserAuthPayload!) {\n        login(data: $data)\n      }\n    `;\n\n    await this.apollo.mutate({\n      mutation: LOGIN,\n      variables: {\n        data: {\n          email: email,\n          password: password,\n        }\n      }\n    }).subscribe(({data}) => {\n      this.tokenObj = data;\n\n      this.notification.showSuccess('Login success', 'trendradar.com');\n      this.router.navigateByUrl('home'); // redirect to home\n\n    }, (error) => {\n      this.notification.showError('Something gone wrong', 'trendradar.com');\n    });\n\n    let date: Date = new Date(\"2019-01-16\");\n    console.log('in authservice : ' + this.tokenObj);\n    return this.tokenObj;\n  }\n\n  signUp(email: string, password: string): any{\n    const REGISTER = gql`\n      mutation signupUser($data: UserCreateInput!) {\n        signupUser(data: $data){\n          id\n          name\n        }\n      }\n    `;\n\n    this.apollo.mutate({\n      mutation: REGISTER,\n      variables: {\n        data: {\n          email: email,\n          name: email,\n          password: password,\n        }\n      }\n    }).subscribe(({data}) => {\n      console.log(data);\n      this.notification.showSuccess('Login success', 'trendradar.com');\n      this.router.navigateByUrl('home'); // redirect to home\n      return {data}\n    }, (error) => {\n      this.notification.showError('Something gone wrong', 'trendradar.com');\n    });\n  }\n\n  formatUser(email: string, token: string, localId: string, expriration: Date ): User{\n    return new User(email,token, localId, expriration);\n  }\n}\n"],"sourceRoot":""},"metadata":{},"sourceType":"module"}